{
    "info": {
        "name": "Foody API - Manager India Flow (Automated)",
        "description": "**Automated Manager India User Testing Collection**\n\nThis collection tests the complete manager workflow with automatic authentication and country-based restrictions.\n\n## Auto-Login\nThe collection automatically logs in as Manager India and updates the auth token for all subsequent requests.\n\n## Test Credentials\n- Email: captain.marvel@foody.com\n- Password: ChangeMe123!\n- Role: MANAGER_INDIA\n- Country: INDIA\n\n## Execution Order\n1. Login (auto-saves token)\n2. View India restaurants only\n3. Create/Update menu items for India restaurants\n4. Create payment method\n5. Create orders (Manager can place orders)\n6. Update order status\n7. View orders from India members\n\n## Restrictions\n- Can only view/manage INDIA restaurants\n- Can only see orders from MEMBER_INDIA users\n- Cannot access admin-only features\n\n## Usage\nRun the entire collection using Collection Runner for automated testing.\n\n**Version:** 1.0.0\n**Role:** MANAGER_INDIA\n**Last Updated:** November 2025",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "auth": {
        "type": "bearer",
        "bearer": [
            {
                "key": "token",
                "value": "{{auth_token}}",
                "type": "string"
            }
        ]
    },
    "variable": [
        {
            "key": "baseUrl",
            "value": "http://localhost:4000",
            "type": "string",
            "description": "Base URL for the API server"
        },
        {
            "key": "graphql",
            "value": "{{baseUrl}}/graphql",
            "type": "string",
            "description": "GraphQL endpoint URL"
        },
        {
            "key": "auth_token",
            "value": "",
            "type": "string",
            "description": "JWT authentication token (automatically set after login)"
        },
        {
            "key": "manager_email",
            "value": "captain.marvel@foody.com",
            "type": "string",
            "description": "Manager India login email address"
        },
        {
            "key": "manager_password",
            "value": "ChangeMe123!",
            "type": "string",
            "description": "Manager India login password"
        },
        {
            "key": "restaurant_id",
            "value": "",
            "type": "string",
            "description": "Restaurant ID for testing restaurant operations"
        },
        {
            "key": "menu_item_id",
            "value": "",
            "type": "string",
            "description": "Menu item ID for testing menu operations"
        },
        {
            "key": "payment_method_id",
            "value": "",
            "type": "string",
            "description": "Payment method ID for testing payment operations"
        },
        {
            "key": "order_id",
            "value": "",
            "type": "string",
            "description": "Order ID for testing order operations"
        }
    ],
    "item": [
        {
            "name": "01 - Login as Manager India",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Manager login successful\", function () {",
                            "    pm.response.to.have.status(200);",
                            "    const response = pm.response.json();",
                            "    pm.expect(response.data.login).to.have.property('token');",
                            "    pm.expect(response.data.login.user.role).to.equal('MANAGER_INDIA');",
                            "    pm.expect(response.data.login.user.country).to.equal('INDIA');",
                            "    ",
                            "    const token = response.data.login.token;",
                            "    pm.collectionVariables.set(\"auth_token\", token);",
                            "    console.log(\"âœ… Manager India authenticated successfully\");",
                            "});"
                        ]
                    }
                }
            ],
            "request": {
                "auth": {
                    "type": "noauth"
                },
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "graphql",
                    "graphql": {
                        "query": "mutation Login($input: LoginInput!) {\n  login(input: $input) {\n    token\n    user {\n      id\n      email\n      role\n      country\n    }\n  }\n}",
                        "variables": "{\n  \"input\": {\n    \"email\": \"{{manager_email}}\",\n    \"password\": \"{{manager_password}}\"\n  }\n}"
                    }
                },
                "url": {
                    "raw": "{{graphql}}",
                    "host": ["{{graphql}}"]
                }
            }
        },
        {
            "name": "02 - Get Current User (Verify Manager)",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Current user is Manager India\", function () {",
                            "    const response = pm.response.json();",
                            "    pm.expect(response.data.me.role).to.equal('MANAGER_INDIA');",
                            "    pm.expect(response.data.me.country).to.equal('INDIA');",
                            "    console.log(\"âœ… Manager India role verified\");",
                            "});"
                        ]
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "graphql",
                    "graphql": {
                        "query": "query Me {\n  me {\n    id\n    email\n    role\n    country\n  }\n}"
                    }
                },
                "url": {
                    "raw": "{{graphql}}",
                    "host": ["{{graphql}}"]
                }
            }
        },
        {
            "name": "03 - Get India Restaurants Only",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Only India restaurants visible\", function () {",
                            "    const response = pm.response.json();",
                            "    pm.expect(response.data.restaurants).to.be.an('array');",
                            "    response.data.restaurants.forEach(restaurant => {",
                            "        pm.expect(restaurant.country).to.equal('INDIA');",
                            "    });",
                            "    if (response.data.restaurants.length > 0) {",
                            "        pm.collectionVariables.set(\"restaurant_id\", response.data.restaurants[0].id);",
                            "        console.log(\"âœ… India restaurant ID saved:\", response.data.restaurants[0].id);",
                            "    }",
                            "});"
                        ]
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "graphql",
                    "graphql": {
                        "query": "query Restaurants {\n  restaurants {\n    id\n    name\n    country\n    city\n  }\n}"
                    }
                },
                "url": {
                    "raw": "{{graphql}}",
                    "host": ["{{graphql}}"]
                }
            }
        },
        {
            "name": "04 - Get India Menu Items",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Menu items retrieved\", function () {",
                            "    const response = pm.response.json();",
                            "    pm.expect(response.data.menuItems).to.be.an('array');",
                            "    if (response.data.menuItems.length > 0) {",
                            "        const indiaItem = response.data.menuItems.find(item => item.restaurant.country === 'INDIA');",
                            "        if (indiaItem) {",
                            "            pm.collectionVariables.set(\"menu_item_id\", indiaItem.id);",
                            "            console.log(\"âœ… India menu item ID saved:\", indiaItem.id);",
                            "        }",
                            "    }",
                            "});"
                        ]
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "graphql",
                    "graphql": {
                        "query": "query MenuItems {\n  menuItems {\n    id\n    name\n    price\n    restaurant {\n      id\n      country\n    }\n  }\n}"
                    }
                },
                "url": {
                    "raw": "{{graphql}}",
                    "host": ["{{graphql}}"]
                }
            }
        },
        {
            "name": "05 - Create Menu Item for India Restaurant",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Menu item created for India restaurant\", function () {",
                            "    const response = pm.response.json();",
                            "    pm.expect(response.data.createMenuItem).to.have.property('id');",
                            "    pm.expect(response.data.createMenuItem.restaurant.country).to.equal('INDIA');",
                            "    pm.collectionVariables.set(\"menu_item_id\", response.data.createMenuItem.id);",
                            "    console.log(\"âœ… India menu item created:\", response.data.createMenuItem.id);",
                            "});"
                        ]
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "graphql",
                    "graphql": {
                        "query": "mutation CreateMenuItem($input: CreateMenuItemInput!) {\n  createMenuItem(input: $input) {\n    id\n    name\n    price\n    restaurant {\n      country\n    }\n  }\n}",
                        "variables": "{\n  \"input\": {\n    \"name\": \"Paneer Tikka - Manager Test\",\n    \"description\": \"Automated test menu item by Manager India\",\n    \"price\": 12.99,\n    \"category\": \"Appetizer\",\n    \"restaurantId\": \"{{restaurant_id}}\"\n  }\n}"
                    }
                },
                "url": {
                    "raw": "{{graphql}}",
                    "host": ["{{graphql}}"]
                }
            }
        },
        {
            "name": "06 - Update Menu Item",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Menu item updated\", function () {",
                            "    const response = pm.response.json();",
                            "    pm.expect(response.data.updateMenuItem.price).to.equal(13.99);",
                            "    console.log(\"âœ… Menu item price updated\");",
                            "});"
                        ]
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "graphql",
                    "graphql": {
                        "query": "mutation UpdateMenuItem($id: ID!, $input: UpdateMenuItemInput!) {\n  updateMenuItem(id: $id, input: $input) {\n    id\n    price\n  }\n}",
                        "variables": "{\n  \"id\": \"{{menu_item_id}}\",\n  \"input\": {\n    \"price\": 13.99\n  }\n}"
                    }
                },
                "url": {
                    "raw": "{{graphql}}",
                    "host": ["{{graphql}}"]
                }
            }
        },
        {
            "name": "07 - Create Payment Method",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Payment method created\", function () {",
                            "    const response = pm.response.json();",
                            "    pm.expect(response.data.createPaymentMethod).to.have.property('id');",
                            "    pm.collectionVariables.set(\"payment_method_id\", response.data.createPaymentMethod.id);",
                            "    console.log(\"âœ… Payment method created:\", response.data.createPaymentMethod.id);",
                            "});"
                        ]
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "graphql",
                    "graphql": {
                        "query": "mutation CreatePaymentMethod($input: CreatePaymentMethodInput!) {\n  createPaymentMethod(input: $input) {\n    id\n    type\n    provider\n  }\n}",
                        "variables": "{\n  \"input\": {\n    \"type\": \"CREDIT_CARD\",\n    \"provider\": \"STRIPE\",\n    \"token\": \"tok_manager_india\"\n  }\n}"
                    }
                },
                "url": {
                    "raw": "{{graphql}}",
                    "host": ["{{graphql}}"]
                }
            }
        },
        {
            "name": "08 - Create Order (Manager Can Order)",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Order created by Manager India\", function () {",
                            "    const response = pm.response.json();",
                            "    pm.expect(response.data.createOrder).to.have.property('id');",
                            "    pm.collectionVariables.set(\"order_id\", response.data.createOrder.id);",
                            "    console.log(\"âœ… Order created:\", response.data.createOrder.id);",
                            "});"
                        ]
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "graphql",
                    "graphql": {
                        "query": "mutation CreateOrder($input: CreateOrderInput!) {\n  createOrder(input: $input) {\n    id\n    totalAmount\n    status\n  }\n}",
                        "variables": "{\n  \"input\": {\n    \"items\": [\n      {\n        \"menuItemId\": \"{{menu_item_id}}\",\n        \"quantity\": 1,\n        \"notes\": \"Medium spicy\"\n      }\n    ],\n    \"deliveryAddress\": \"456 Manager Street, Bangalore, India\",\n    \"phone\": \"+91-9988776655\",\n    \"paymentMethodId\": \"{{payment_method_id}}\"\n  }\n}"
                    }
                },
                "url": {
                    "raw": "{{graphql}}",
                    "host": ["{{graphql}}"]
                }
            }
        },
        {
            "name": "09 - Get Orders (India Members Only)",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Orders retrieved\", function () {",
                            "    const response = pm.response.json();",
                            "    pm.expect(response.data.orders).to.be.an('array');",
                            "    console.log(\"âœ… Retrieved\", response.data.orders.length, \"orders\");",
                            "});"
                        ]
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "graphql",
                    "graphql": {
                        "query": "query Orders {\n  orders {\n    id\n    status\n    totalAmount\n    user {\n      email\n      role\n      country\n    }\n  }\n}"
                    }
                },
                "url": {
                    "raw": "{{graphql}}",
                    "host": ["{{graphql}}"]
                }
            }
        },
        {
            "name": "10 - Update Order Status",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Order status updated by Manager\", function () {",
                            "    const response = pm.response.json();",
                            "    pm.expect(response.data.updateOrderStatus.status).to.equal('CONFIRMED');",
                            "    console.log(\"âœ… Order status updated to CONFIRMED\");",
                            "});"
                        ]
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "graphql",
                    "graphql": {
                        "query": "mutation UpdateOrderStatus($id: ID!, $status: OrderStatus!) {\n  updateOrderStatus(id: $id, status: $status) {\n    id\n    status\n  }\n}",
                        "variables": "{\n  \"id\": \"{{order_id}}\",\n  \"status\": \"CONFIRMED\"\n}"
                    }
                },
                "url": {
                    "raw": "{{graphql}}",
                    "host": ["{{graphql}}"]
                }
            }
        },
        {
            "name": "11 - Process Payment",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Payment processed\", function () {",
                            "    const response = pm.response.json();",
                            "    pm.expect(response.data.processPayment).to.have.property('id');",
                            "    pm.expect(response.data.processPayment.status).to.equal('COMPLETED');",
                            "    console.log(\"âœ… Payment processed successfully\");",
                            "});"
                        ]
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "graphql",
                    "graphql": {
                        "query": "mutation ProcessPayment($input: ProcessPaymentInput!) {\n  processPayment(input: $input) {\n    id\n    amount\n    status\n  }\n}",
                        "variables": "{\n  \"input\": {\n    \"orderId\": \"{{order_id}}\",\n    \"paymentMethodId\": \"{{payment_method_id}}\",\n    \"amount\": 13.99\n  }\n}"
                    }
                },
                "url": {
                    "raw": "{{graphql}}",
                    "host": ["{{graphql}}"]
                }
            }
        },
        {
            "name": "12 - Get Payment Methods",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Payment methods retrieved\", function () {",
                            "    const response = pm.response.json();",
                            "    pm.expect(response.data.paymentMethods).to.be.an('array');",
                            "    console.log(\"âœ… Payment methods listed\");",
                            "});"
                        ]
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "graphql",
                    "graphql": {
                        "query": "query PaymentMethods {\n  paymentMethods {\n    id\n    type\n    provider\n    isDefault\n  }\n}"
                    }
                },
                "url": {
                    "raw": "{{graphql}}",
                    "host": ["{{graphql}}"]
                }
            }
        },
        {
            "name": "13 - Delete Menu Item (Cleanup)",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Menu item deleted\", function () {",
                            "    const response = pm.response.json();",
                            "    pm.expect(response.data.deleteMenuItem).to.be.true;",
                            "    console.log(\"âœ… Menu item deleted\");",
                            "    console.log(\"\\nðŸŽ‰ Manager India flow completed successfully!\");",
                            "});"
                        ]
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "graphql",
                    "graphql": {
                        "query": "mutation DeleteMenuItem($id: ID!) {\n  deleteMenuItem(id: $id)\n}",
                        "variables": "{\n  \"id\": \"{{menu_item_id}}\"\n}"
                    }
                },
                "url": {
                    "raw": "{{graphql}}",
                    "host": ["{{graphql}}"]
                }
            }
        }
    ]
}
